# Supabase Edge Functions 価格体系

## 概要

Supabase Edge Functions は、サーバーレス JavaScript/TypeScript 関数を実行するサービスです。本ドキュメントでは、2025年時点での価格体系と技術的制限について説明します。

## 料金プラン別の Edge Functions 提供内容

### Free プラン（無料）
- **月間実行回数**: 500,000回まで無料
- **実行時間制限**: 最大150秒
- **関数数制限**: 100個まで
- **メモリ制限**: 256MB
- **適用対象**: 個人プロジェクト、プロトタイプ開発

### Pro プラン（$25/月）
- **月間実行回数**: 2,000,000回まで無料
- **実行時間制限**: 最大400秒
- **関数数制限**: 500個まで
- **超過料金**: $2 per 1,000,000回
- **適用対象**: 小規模〜中規模の本番アプリケーション

### Team プラン（$125/月）
- **月間実行回数**: 2,000,000回まで無料（Proと同じ）
- **実行時間制限**: 最大400秒
- **関数数制限**: 1,000個まで
- **超過料金**: $2 per 1,000,000回
- **適用対象**: チーム開発、複数プロジェクト管理

### Enterprise プラン（要相談）
- **月間実行回数**: カスタム
- **制限**: すべてカスタマイズ可能
- **料金**: 営業チームと要相談
- **適用対象**: 大規模エンタープライズ

## 技術的制限

### 実行環境制限
- **メモリ**: 最大256MB
- **CPU時間**: リクエストあたり2秒
- **アイドルタイムアウト**: 150秒
- **関数サイズ**: 最大20MB（CLI bundling後）

### 接続制限
- **ポート制限**: 25番・587番ポートへの外部接続不可
- **HTML配信**: カスタムドメインでのみサポート
- **制限API**: Web Worker、Node `vm` API は利用不可

### ログ制限
- **ログメッセージ長**: 最大10,000文字
- **ログイベント閾値**: 10秒間に100イベント

## Plain Text Scraperプロジェクトでの想定コスト

### 使用量別コスト試算

| 月間使用回数 | 推奨プラン | 月額コスト | 備考 |
|-------------|-----------|-----------|------|
| 1,000回 | Free | $0 | 個人利用・テスト |
| 100,000回 | Free | $0 | 軽い商用利用 |
| 500,000回 | Free | $0 | Free上限ギリギリ |
| 1,000,000回 | Pro | $25 | 無料枠内で利用 |
| 2,000,000回 | Pro | $25 | Pro上限ギリギリ |
| 3,000,000回 | Pro | $27 | 100万回分の超過料金 |
| 5,000,000回 | Pro | $31 | 300万回分の超過料金 |

### 1回のスクレイピングあたりのコスト
- **Pro プラン超過時**: $0.000002（200万円分の1円）
- **実質的なコスト**: 極めて低コスト

## コスト最適化の提案

### 1. Rate Limiting の活用
- 現在の実装: 1分間に5回制限
- 効果: 不正利用やスパムからの保護

### 2. キャッシュ戦略
- 同一URLの重複リクエストを一定時間キャッシュ
- データベースでの重複チェック実装

### 3. バッチ処理
- 複数URLの一括処理機能
- 1回の関数実行で複数URL処理

### 4. エラーハンドリング
- 失敗時の再試行ロジック最適化
- 無駄な実行回数を削減

## 監視・アラート設定

### 使用量監視
- Supabaseダッシュボードでリアルタイム監視
- 月間使用量の80%でアラート設定を推奨

### コスト管理
- Pro プランでは$25の基本料金上限設定可能
- 意図しない超過課金を防止

## まとめ

Plain Text Scraperプロジェクトにおいて、Edge Functionsのコストは非常に低く抑えられます。月間100万回の使用でもPro プランの無料枠内で収まるため、スケーラブルなサービス構築が可能です。

適切な制限とキャッシュ戦略により、さらなるコスト最適化も実現できます。